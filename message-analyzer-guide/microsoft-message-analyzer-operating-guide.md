---
title: "Microsoft Message Analyzer Operating Guide | Microsoft Docs"
ms.custom: ""
ms.date: "10/26/2016"
ms.prod: "windows-server-threshold"
ms.reviewer: ""
ms.suite: ""
ms.technology: "networking"
ms.tgt_pltfrm: ""
ms.topic: "article"
ms.assetid: 5c07a0dd-c467-4f1a-a80f-0dcb0a00e406
caps.latest.revision: 189
author: "greggigwg"
ms.author: "greggill"
manager: "ronstarr"
---

# Microsoft Message Analyzer Operating Guide

| | |
|-|-|
|![Message Analyzer](media/fig-x-messageanalyzericon.png "Fig-x-MessageAnalyzerIcon")|**Important** <br />Microsoft Message Analyzer (MMA) is being retired and its download packages removed from microsoft.com sites on November 25 2019.  There is currently no Microsoft replacement for Microsoft Message Analyzer in development at this time. If you already have Microsoft Message Analyzer installed, you may continue to use it, along with the OPN parsers you have already downloaded. Parsing ETW traces will also continue to work as before. After November 25 2019 when MMA is launched, it will attempt to connect to the back-end Feed service to check News and Assets updates and an error message will appear. To dismiss this errror message, see [Dismiss Error Message](procedures-using-the-asset-management-features.md#BKMK_DismissError).<br /><br />**Introduction** <br />Microsoft Message Analyzer is a tool for capturing, displaying, and analyzing protocol messaging traffic, events, and other system or application messages in network troubleshooting and other diagnostic scenarios. Message Analyzer also enables you to load, aggregate, and analyze data from log and saved trace files. It is the successor to *Microsoft Network Monitor 3.4* and is a key component in the Protocol Engineering Framework (PEF) that was created by Microsoft to improve protocol design, development, implementation testing and verification, documentation, and support. With Message Analyzer, you can choose to capture local and remote traffic live or load archived message collections from multiple data sources simultaneously.<br /><br /> <br /><br /> Message Analyzer enables you to display trace, log, and other message data in numerous data viewer formats, including a default tree-grid view, interactive Tool Windows, and other selectable graphical view **Layouts** that employ grids, bar element, timeline, and other visualizer components that provide high-level data summaries and other prominent statistics. You also have the option to configure your own custom **Layouts** for the **Chart** viewer. In addition, Message Analyzer now  provides a **Profiles** feature, which creates interactive and integrated analysis environments that automatically display preset viewer and **Layout** configurations when data from specific input file types is loaded.<br /><br /> <br /><br /> **Quick Links** <br />  **[New Features and Updates](new-features-and-updates.md)**  — find out what's new in the latest release of Microsoft Message Analyzer.<br />**[Message Analyzer User Roles](message-analyzer-user-roles.md)** — determine your User Role and navigate to topics that help you get started with Message Analyzer in your role.<br />**[Message Analyzer Tutorial](message-analyzer-tutorial.md)** — take a detailed tour of Message Analyzer to learn about its capabilities, functions, and features.<br />**[Quick Session Startup](quick-session-startup.md)** — start a new Message Analyzer local trace session with a single click.<br />**[Procedures: Quick Start](procedures-quick-start.md)** — see Message Analyzer in action right now by running several simple procedures.<br />**[Important for Network Monitor Users](message-analyzer-feature-summary.md#BKMK_NetmonUsers)** — review information about the differences between Network Monitor and Message Analyzer.<br />**[Feedback](message-analyzer-community-additions.md)** — provide feedback on any topic in this Operating Guide.<br /><br /> <br /><br /> **Other Links** <br />  **[Installing and Upgrading Message Analyzer](installing-and-upgrading-message-analyzer.md)**  — get a *free download* and install or upgrade Message Analyzer on your system. <br />**[Starting Message Analyzer for the First Time](installing-and-upgrading-message-analyzer.md#BKMK_StartingMAFirstTime)** — learn about how to run Message Analyzer as an Administrator, security contexts and restrictions, and syncing Message Analyzer assets for automatic updates.<br />**[Training Videos](https://www.youtube.com/playlist?list=PLszrKxVJQz5Uwi90w9j4sQorZosTYgDO4)** — view several supplemental training videos to help you get started with Microsoft Message Analyzer.<br />**[Participating in the Message Analyzer Community](participating-in-the-message-analyzer-community.md)** — review options for participating in various Message Analyzer community venues.<br />**[Download PDF](https://docs.microsoft.com/en-us/message-analyzer/opbuildpdf/toc.pdf?branch=live)** — download a PDF copy of this Operating Guide.|




## Information Roadmap

 The topics outlined in this section provide a map into the documentation contained in the Message Analyzer Operating Guide. Use this map to quickly navigate to the topics that show you how to get started with Message Analyzer, how to use its basic and more advanced features, and to understand the underlying frameworks on which it is built. At a high level, the map breaks out into the three content spaces that are specified in the following table, within which you will find quick links that point to topics of interest in these spaces:

|**Content Space**|**Description**|**Navigation**|
|-----------------------|---------------------|--------------------|
|**Usage tasks**|Review features and functions that you can use to perform various Message Analyzer operations.|[Message Analyzer Usage Tasks](microsoft-message-analyzer-operating-guide.md#BKMK_GuidanceScenarios)|
|**Usage procedures**|Run procedures to see Message Analyzer in action and quickly familiarize yourself with its capabilities.|[Message Analyzer Usage Procedures](microsoft-message-analyzer-operating-guide.md#BKMK_GoToProcedures)|
|**Technology concepts**|Review conceptual information to understand Message Analyzer features and the underlying technologies upon which they are built.|[Message Analyzer Technology Concepts](microsoft-message-analyzer-operating-guide.md#BKMK_ConceptualOverviews)|

<a name="BKMK_GuidanceScenarios"></a>
## Message Analyzer Usage Tasks

 In this Operating Guide, Message Analyzer guidance is presented in the form of usage tasks. Each task provides some conceptual background with respect to the functions and features you will be working with, discusses how to use the associated UI features, and also includes example procedures to help you walk through various Message Analyzer usage contexts. To proceed directly to the usage tasks presented in this Operating Guide, click a task link below such as *Capturing Message Data*:

| | |
|-|-|
|**[Getting Started with Message Analyzer](getting-started-with-message-analyzer.md)**<br /><br /> See the following topics to learn how to get started with Message Analyzer:<br /><br /> -   **[New Features and Updates](new-features-and-updates.md)**  — read about the new and updated features in the latest release of Message Analyzer.<br />-   [Installing and Upgrading Message Analyzer](installing-and-upgrading-message-analyzer.md) — learn about Message Analyzer installation requirements, options, and other information, which includes upgrades from earlier Message Analyzer release versions, preserving user-created assets from prior installations, window docking layout changes, security contexts, and auto-syncing Message Analyzer assets for updates.<br />-   **[Message Analyzer User Roles](message-analyzer-user-roles.md)**  — determine your User Role based on how you intend to use Message Analyzer and navigate to topics that help you get started.<br />-   [Message Analyzer Feature Summary](message-analyzer-feature-summary.md) — review the main features of Message Analyzer and use the topic links to access more detailed feature descriptions.<br />-   **[Quick Session Startup](quick-session-startup.md)**  — learn about various methods you can use to very quickly start a new Message Analyzer session with a minimum of clicks.<br />-   [Technology Tutorials](technology-tutorials.md) — read a tutorial on Message Analyzer functions before you dive into the usage tasks and procedures. Optionally, review the Protocol Engineering Framework (PEF) architecture and Event Tracing for Windows (ETW) framework tutorials to understand the technologies upon which Message Analyzer is built.<br />-   [Message Analyzer Startup Options](message-analyzer-startup-options.md) — review the methods you can use to start Message Analyzer, which includes the arguments and command switches that are available to launch Message Analyzer from the command line.<br />-   [Setting Message Analyzer Global Options](setting-message-analyzer-global-options.md) — set global options such as default values and settings that can affect Message Analyzer performance, display configurations, feature activations, and **Profile** activations.<br />-   **[Procedures: Quick Start](procedures-quick-start.md)**  — run several simple procedures to quickly see Message Analyzer in action.|**[Capturing Message Data](capturing-message-data.md)**<br /><br /> Review the following topics to learn how to configure, start, and edit a Message Analyzer session, or configure a session scenario that targets multiple data sources, including local and multiple concurrent remote sessions. Discover how to start a session with a single click, how to use predefined **Trace Scenario** configurations and other  message providers, how to create and save custom Live Trace Session configurations to run on-demand, how to use decryption, and how to enhance capture configurations with filtering, ETW system providers, and promiscuous mode:<br /><br /> -   **[Starting a Message Analyzer Session](starting-a-message-analyzer-session.md)**  — familiarize yourself with the types of sessions you can configure and start with Message Analyzer; also review common steps that you can use to create a basic session.<br />-   [Targeting Live Data as an Input Source](targeting-live-data-as-an-input-source.md) — learn about the many different message providers that Message Analyzer uses as a source for live input data. Also learn about built-in **Trace Scenarios**, quickly starting a **Trace Scenario**, using system ETW providers, optimizing capture configurations, and session configuration workflow.<br />-   **[Configuring a Live Trace Session](configuring-a-live-trace-session.md)**  — select and configure predefined **Trace Scenarios**, set predefined **Parsing Levels**, configure **Fast Filters** and **Session Filters**, configure system ETW providers, use advanced session configuration, select data viewers, and more.<br />-   [Built-In Trace Scenarios](built-in-trace-scenarios.md) — review the functions and usage configurations of the built-in Message Analyzer **Trace Scenarios** in the **Network**, **Device**, **System**, and **File Sharing** categories.<br />-   [Decrypting TLS and SSL Encrypted Data](decrypting-tls-and-ssl-encrypted-data.md) — specify a server certificate and password to enable decryption and analysis of TLS/SSL encrypted traffic, which includes TCP, HTTP, and Remote Desktop Protocol (RDP) messages.<br />-   [Selecting Data to Capture](selecting-data-to-capture.md) —  learn how to configure a Live Trace Session to capture specifically targeted data by applying a **Session Filter** and/or a **Parsing Level**.<br />-   [Configuring a Remote Capture](configuring-a-remote-capture.md) — learn how to capture traffic concurrently on multiple remote hosts, which includes traffic on virtual machines that are serviced by a Hyper-V-Switch, along with advanced packet filtering and other special filters.<br />-   [Promiscuous Mode](microsoft-windows-ndis-packetcapture-provider.md#BKMK_CaptureInPMode) — learn how to capture data in P-Mode, if supported by your network adapter.<br />-   [Creating and Managing Custom Trace Scenarios](creating-and-managing-custom-trace-scenarios.md) — design a custom capture configuration template, save it as a **Trace Scenario**, and run it on demand.<br />-   [Editing Existing Sessions](editing-existing-sessions.md) — learn how to reconfigure an existing session and apply the changes to existing data.<br />-   [Configuring Session Scenarios with Selected Data Sources](configuring-session-scenarios-with-selected-data-sources.md) — discover how to make use of the flexible session framework with multiple data sources capability that enables you to create Data Retrieval Sessions with multiple data loading configurations or Live Trace Sessions with multiple capture configurations for local and remote tracing.|
|**[Retrieving Message Data](retrieving-message-data.md)**<br /><br /> Review the following topics to learn how to load input data from saved files, filter input data, and present it in a chosen viewer when loading messages through a Message Analyzer Data Retrieval Session:<br /><br /> -   [Browse-Select-View Model](browse-select-view-model.md) — learn about the Message Analyzer BSV infrastructure that enables you to browse for multiple data sources, filter or *select* specific data from those sources, and present results in a viewer of choice for data manipulation and analysis.<br />-   [Targeting Saved Data as an Input Source](targeting-saved-data-as-an-input-source.md) — browse for and load saved  data from  numerous log and trace file types into Message Analyzer, for example, \*.matp, \*.cap, \*.evtx, .etl, \*.log, \*.csv, \*.oms, \*ps1, \*.dmp, and \*.saz files.<br />-   **[Configuring a Data Retrieval Session](configuring-a-data-retrieval-session.md)**  — learn how to configure a Data Retrieval Session and make use of such features as session **Filtering**, **Truncated Parsing**,  **Parsing Levels**, **Decryption**, Text log parsing, and more.<br />-   [Selecting Data to Retrieve](selecting-data-to-retrieve.md) — learn how to use a **Session Filter**,  a **Time Filter**,  and/or a **Parsing Level** to select specific data in a trace that you want to load into Message Analyzer.<br />-   [Acquiring Data From Other Input Sources](acquiring-data-from-other-input-sources.md) — learn about other unique input data sources that Message Analyzer supports, such as Azure, Event Log, and SQL data;   along with Operations Management Suite (OMS) log data and WPP-generated events. Also see [Working With Special Input Requirements](working-with-special-input-requirements.md) to learn about text log support.<br />-   [Selecting a Data Retrieval Session Viewer](selecting-a-data-retrieval-session-viewer.md) — learn how to specify a data viewer that displays message data that you load from one or more data sources in a Data Retrieval  Session.<br />-   [Loading WPP-Generated Events](loading-wpp-generated-events.md) — learn how to enable parsing of Windows software trace preprocessor (WPP)-generated events in Message Analyzer.|**[Viewing Message Data](viewing-message-data.md)**<br /><br /> Review the following topics to learn about the different data viewers that Message Analyzer provides, along with the capabilities that enable you to manipulate data views:<br /><br /> -   [Data Viewer Concepts](data-viewer-concepts.md) — review background concepts about the Message Analyzer data viewing infrastructure to learn the basics on how data viewers work and interact.<br />-   **[Data Viewers](data-viewers.md)**  — learn about the data viewers that are available for data analysis, including the [Analysis Grid Viewer](analysis-grid-viewer.md), [Grouping Viewer](grouping-viewer.md), [Pattern Match Viewer](pattern-match-viewer.md),  [Gantt Viewer](gantt-viewer.md), and others, along with their associated data manipulation components. Also discover how to use [Chart Viewer Layouts](chart-viewer-layouts.md) to display top-level protocol summary information and computed statistical values in graphic data visualizers for targeted analysis.<br />-   [Session Data Viewer Options](session-data-viewer-options.md) — find out how to open various data viewers from multiple locations.<br />-   [Common Data Viewer Features](common-data-viewer-features.md) — learn about Message Analyzer data manipulation tools that are common to the **Analysis Grid** and other viewers, such as view **Filters**, **Time Filters**, **Viewpoints**,  **Operations**, **Aliases**, **Unions**, **Time Shifts**, and the **Flat Message List** feature that simulates the Network Monitor view.<br />-   **[Tool Windows](tool-windows.md)**  — understand how to use message-specific and session-specific **Tool Windows** that provide additional message details or configuration capabilities in Message Analyzer, for example, the **Diagnostics**, **Details**, **Message Stack**, **Decryption**, **Selection**, **Bookmarks**, and other **Tool Windows**.<br />-   [Working with Message Analyzer Window Layouts](working-with-message-analyzer-window-layouts.md) — learn how to create a customized working environment by selecting viewer and **Tool Window** preset configurations. Also learn how to  use the redocking feature for data viewers and **Tool Windows**.<br />-   **[Working With Message Analyzer Profiles](working-with-message-analyzer-profiles.md)**  — learn how to display a focused analysis environment by selecting a built-in or custom-designed data viewer and **Layout** preset configuration that automatically displays whenever you are loading data from a specific type of input file with which a **Profile** is associated.|
|**[Filtering Message Data](filtering-message-data.md)**<br /><br /> View the following topics to learn about selecting data in a Data Retrieval Session, applying filters to a Live Trace Session to isolate specific data, applying filters to trace results for analysis, using **Color Rules** to create conditional alerts or flags in a set of trace results, and understanding the Filtering Language:<br /><br /> -   [Filtering Loaded Input Data](filtering-loaded-input-data.md) — apply a **Session Filter** to isolate specific data from a specified input file/s configuration.<br />-   [Filtering Captured Input Data](filtering-captured-input-data.md) — apply a **Fast Filter**, **Keyword** filter, **WFP Layer Set** filter, **Advanced Settings** filters, or an HTTP filter at the driver level to a Live Trace Session, or apply a predefined or custom Filter Expression as a **Session Filter** in the **New Session** dialog when configuring a Live Trace Session.<br />-   **[Filtering Live Trace Session Results](filtering-live-trace-session-results.md)**  — select a filter expression from the common **Library** of predefined filters and apply it as a view **Filter** to the results of a Live Trace Session.<br />-   [Writing Filter Expressions](writing-filter-expressions.md) — understand the Filtering Language so you can create your own filter expressions.|**[Saving Message Data](saving-message-data.md)**<br /><br /> Review the following topics to learn how to save session data, which includes selecting messages to save, specifying the save file format, and using session naming conventions.<br /><br /> -   [Saving Session Data](saving-session-data.md) — read a quick overview of how to save your message data from a Data Retrieval Session or a Live Trace Session.<br />-   [Selecting Messages to Save](selecting-messages-to-save.md) — review the options that are available for saving message data.<br />-   [Naming Saved Files](naming-saved-files.md) — review some naming strategies and other considerations for saving message data.<br /><br /> **[Automating Tracing Functions with PowerShell](automating-tracing-functions-with-powershell.md)**<br /><br /> Get a quick overview of the Message Analyzer functions that are enabled for the PowerShell scripting environment, as described in the following topics:<br /><br /> -   [Using PowerShell Cmdlets](automating-tracing-functions-with-powershell.md#BKMK_pshellcmdlets) — read a synopsis of action, trigger, and other cmdlets that are available to automate various Message Analyzer functions and operations.<br />-   [Examining a PowerShell Script Example](automating-tracing-functions-with-powershell.md#BKMK_PSScriptExample) —  review an example PowerShell script that configures a message provider, adds a **Trace Filter**, and sets various triggers for starting, filtering, stopping, and saving a trace session.<br />-   [Accessing PowerShell Cmdlets and Help](automating-tracing-functions-with-powershell.md#BKMK_AccessingPSFunctionality) — find out how to get PowerShell v3, access and update cmdlet help, and view the cmdlet help for Message Analyzer.|
|**[Managing Message Analyzer Assets](managing-message-analyzer-assets.md)**<br /><br /> Review the following topics to learn about the Message Analyzer Sharing Infrastructure, user Libraries, automatic asset updates, downloading asset collections, and creating user feeds for sharing assets with others:<br /><br /> -   [Sharing Infrastructure](sharing-infrastructure.md) — learn about the Message Analyzer Sharing Infrastructure; the user Library item collections that enable you to manipulate how data is captured, viewed, and analyzed; and how to manage these user Libraries.<br />-   [Managing Asset Collection Downloads and Updates](managing-asset-collection-downloads-and-updates.md) — find out how to download user Library item collections and how to utilize the auto-sync feature to automatically receive user Library updates that are pushed out by a Microsoft web service.<br />-   [Managing Microsoft OPN Parser Packages](managing-microsoft-opn-parser-packages.md) — learn how to auto-sync updates to **OPN Parser** packages and download them from the Microsoft web service.<br />-   [Creating Custom User Feeds](creating-custom-user-feeds.md) — create your own user feeds to which others may subscribe, for mutually sharing Message Analyzer assets with other team members, for example, **Filters**, **Trace Scenarios**, **Profiles**, viewer **Layouts**, and so on.<br />-   [Sharing Asset Collections on a User File Share](sharing-asset-collections-on-a-user-file-share.md) — learn how to share user Library item collections directly with other users by exporting/importing collections or items to/from a file share.|**[Extending Message Analyzer Data Viewing Capabilities](extending-message-analyzer-data-viewing-capabilities.md)**<br /><br /> Review the following topics to discover how to create custom **Layouts** for the **Chart** viewer that you can design to your own specifications with the use of various graphic visualizer components and data formulas. Enables you to extend Message Analyzer data viewing capabilities. Also learn how you can edit and customize any built-in **Layout** for the **Chart** viewer:<br /><br /> -   [Configuring Chart Viewer Layouts](configuring-chart-viewer-layouts.md) — learn how to use the Message Analyzer **Chart** viewer **Layout** configuration features to create a new **Layout** of your own design that is customized to your analysis environment.<br />-   [Using the Edit Chart Layout Dialog](using-the-edit-chart-layout-dialog.md) — learn how to use the controls and features of the **Edit Chart Layout** dialog to specify a visualizer component, data field values, and data formulas.<br />-   [Configuration Walkthrough of a Built-In Chart Viewer Layout](configuration-walkthrough-of-a-built-in-chart-viewer-layout.md) — perform a walkthrough of the built-in **TCP/UDP Conversations by Message Count** **Layout** for the **Chart** viewer to familiarize yourself with the configuration features that you can use to create a functioning **Layout** of your own, based on a built-in and functioning **Layout**. Includes specifying graphic visualizer components and creating data formulas that perform various operations on message field values.|

<a name="BKMK_GoToProcedures"></a>
## Message Analyzer Usage Procedures

 If you want to proceed directly to usage procedures that demonstrate Message Analyzer features in the context of the usage tasks contained in this Operating Guide, click a link below:

**[Procedures: Quick Start](procedures-quick-start.md)**  — display saved data with the **Open** feature; start a Live Trace Session; display data quickly from your favorite **Trace Scenarios** by using the **Favorite Scenarios** feature on the Message Analyzer **File** menu or **Start Page**; load saved data through a Data Retrieval Session; and deploy various viewers, which includes **Layouts** for the  **Chart** viewer, to display your data.  

**[Procedures: Using the Network Tracing Features](procedures-using-the-network-tracing-features.md)**  — run a **Local Network Interfaces** trace that isolates data to a particular network adapter and IPv4 address; perform a **Loopback and Unencrypted IPSEC** trace with a high-performance, driver-level **Fast Filter** that is set to capture HTTP traffic from TCP port 80; run a **Pre-Encryption for HTTPS** trace with driver-level **Hostname** and **Port** filters to isolate client and server HTTP message exchanges; capture traffic with a **Remote Network Interfaces** trace on a virtual machine (VM) that is serviced by a Hyper-V-Switch on a remote Windows 8.1, Windows 10, or Windows Server 2012 R2 host; and design a custom **Trace Scenario** and run it on demand.  

**[Procedures: Using the Data Retrieval Features](procedures-using-the-data-retrieval-features.md)**  — browse for data and create a message collection to load into Message Analyzer; apply a **Session Filter** to loaded input data to isolate specific messages that you want to work with; display saved trace data in different viewers; use the **Recent Files** feature to display saved trace data to resume previous work; load data from multiple sources and save it as a single message collection; and apply a **Time Filter** to data being loaded into Message Analyzer.  

**[Procedures: Using the Data Viewing Features](procedures-using-the-data-viewing-features.md)**  — learn how to apply gradient-style **Color Rules** or a built-in view **Layout**; execute **Group** commands to group data and streamline message analysis; use the graphic visualizer components of the **Protocol Dashboard** to analyze top-level summary data such as top bandwidth consumption and message activity within a specified time window; analyze data with the interactive features of the **Protocol Dashboard** and **Analysis Grid** viewers; apply **Quick Filters** and **Viewpoints**; configure friendly **Aliases** for field values; create **Unions** of two or more message fields; and drive the display of various message details through **Analysis Grid** viewer and Tool Window interactions.  

**[Procedures: Using the Data Filtering Features](procedures-using-the-data-filtering-features.md)**  — create and apply filters to the data loading process, live captures, and trace results data to address and solve commonly encountered, real-world issues; create **Color Rules** to serve as an alert when certain message types, states, or values are present in a displayed message set, for example, TCP diagnostic information and SMB error status.  

**[Procedures: Using the Asset Management Features](procedures-using-the-asset-management-features.md)**  — perform procedures that demonstrate how to manage user Library items and share them with others, or download and update Library item collections from the default **Message Analyzer** subscriber feed.  

**[Configuration Walkthrough of a Built-In Chart Viewer Layout](configuration-walkthrough-of-a-built-in-chart-viewer-layout.md)**  — perform a walkthrough of the built-in **TCP/UDP Conversations by Message Count** view **Layout** for **Charts** to familiarize yourself with the configuration features that you can use to create a functioning **Layout** of your own.

<a name="BKMK_ConceptualOverviews"></a>
## Message Analyzer Technology Concepts

 If you want to expand your knowledge of the technologies upon which Message Analyzer is built, click the links below:

**[Technology Tutorials](technology-tutorials.md)**  — get an overview of Message Analyzer functions and technology concepts, and learn about the PEF architecture and ETW framework components that support them:  

[Message Analyzer Tutorial](message-analyzer-tutorial.md)  
[PEF Architecture Tutorial](pef-architecture-tutorial.md)  

[ETW Framework Conceptual Tutorial](etw-framework-conceptual-tutorial.md)

